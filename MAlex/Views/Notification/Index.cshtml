@model List<MAlex.Models.Notification>
@using MAlex.Models;

@{
    ViewData["Title"] = "Notifications";
    Layout = "_Layout";

    string TimeAgo(DateTime dt)
    {
        var span = DateTime.Now - dt;

        if (span.Days > 0) return $"{span.Days} days ago";
        if (span.Hours > 0) return $"{span.Hours} hours ago";
        if (span.Minutes > 0) return $"{span.Minutes} mins ago";
        return "Just now";
    }

    (string icon, string color) GetStyle(NotificationType type)
    {
        return type switch
        {
            NotificationType.Emergency => ("fa-solid fa-triangle-exclamation", "color:#ed021a"),
            NotificationType.Maintenance => ("fa-solid fa-triangle-exclamation", "color:#ed021a"),
            NotificationType.ServiceUpdate => ("fas fa-train-tram", "color:green"),
            NotificationType.Promotion => ("fa-solid fa-circle-info", "color:#007bff"),
            NotificationType.General => ("fa-solid fa-circle-info", "color:#007bff"),
            _ => ("fa-solid fa-circle-info", "color:#007bff")
        };
    }
}

<section>
    <div class="container w-75">
        <div class="shadow rounded-2 p-5">

            <h1 class="text-center pb-2" style="border-bottom:2px solid orange;display:inline-block;">
                Notifications & Updates
            </h1>

            <div class="mt-4">
                <h3>All Notifications (@Model.Count)</h3>

                @if (!Model.Any())
                {
                    <p class="text-center text-muted mt-4 fs-5">
                        There are no notifications.
                    </p>
                }
                else
                {
                    @foreach (var n in Model)
                    {
                        var style = GetStyle(n.Type);

                        <div class="shadow p-3 mt-3 rounded-3">
                            <div class="d-flex align-items-center">
                                <i class="@style.icon fs-3 me-3" style="@style.color"></i>
                                <h4 class="fw-bold mb-0">@n.Title</h4>
                            </div>

                            <p class="mt-2">@n.Message</p>
                            <small class="text-muted">Updated @TimeAgo(n.CreatedAt)</small>
                        </div>
                    }
                }
            </div>

        </div>
    </div>
</section>